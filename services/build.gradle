buildscript {
    repositories {
        mavenCentral()
    }
}

plugins {
    id 'java'
    id 'java-library'
    id 'com.diffplug.spotless' version '6.24.0'
    id 'org.sonarqube' version '4.4.1.3373'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

sonar {
    properties {
        property 'sonar.projectkey', sonarProjectKey
        property 'sonar.organization', sonarOrganization
        property 'sonar.host.url', sonarHost
        property "sonar.branch", sonarBranch
    }
}

subprojects {
    repositories {
        mavenCentral()
    }
    sonar {
        properties {
            property 'sonar.projectkey', sonarProjectKey
            property 'sonar.organization', sonarOrganization
            property 'sonar.host.url', sonarHost
            property "sonar.branch", sonarBranch
        }
    }
    apply plugin: 'java'
    apply plugin: 'com.diffplug.spotless'
    dependencies {
        implementation 'com.google.guava:guava:33.1.0-jre'
        implementation 'org.springframework.boot:spring-boot-starter-web:3.1.2'
        implementation 'org.apache.groovy:groovy:4.0.18'
        implementation 'org.slf4j:slf4j-api:2.0.11'
        implementation 'com.google.code.gson:gson:2.10.1'
        implementation 'org.apache.kafka:kafka-clients:3.6.1'
        implementation 'org.projectlombok:lombok:1.18.30'
        annotationProcessor 'org.projectlombok:lombok:1.18.30'
        implementation 'org.springframework:spring-context:6.1.3'
        implementation 'org.mongodb:mongodb-driver-core:4.11.1'
        implementation 'org.mongodb:mongodb-driver-sync:4.11.1'
        implementation 'org.mongodb:bson:4.11.1'
        testImplementation 'org.awaitility:awaitility:4.2.0'
        testImplementation 'org.mockito:mockito-core:5.10.0'
        testImplementation 'org.junit.jupiter:junit-jupiter:5.10.1'
        testImplementation 'org.mockito:mockito-junit-jupiter:5.10.0'
        testImplementation 'org.junit.platform:junit-platform-launcher:1.10.1'
    }
    spotless {
        java {
            target fileTree('.') {
                include '**/*.java'
                exclude '**/build/**', '**/build-*/**'
            }
            googleJavaFormat()
            licenseHeader '/* WeSmooth! $YEAR */'
        }
    }
    test {
        useJUnitPlatform()
    }
}